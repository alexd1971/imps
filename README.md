# Image processing service (imps)

Сервис обработки изображений

На данный момент реализовано только изменение размера изображения в формате `JPEG` и `PNG`

## Запуск сервиса

```sh
docker run --rm -d --name imps -p 7777:7777 <repository>/imps
```

Если не нужно, чтобы сервис слушал на localhost, то порт можно не пробрасывать

## Запрос к сервису

### Изменение размера изображения

Для изменения размера изображения необходимо сформировать `POST`-запрос к сервису, передав в теле запроса данные изображения и установив заголовок `Content-Type` либо `image/jpeg`, либо `image/png` в зависимости от формата изображения. Значения параметров запроса `w` и `h` определяют требуемые размеры изображения. С помощью параметра `q` можно управлять качеством `JPEG` изображения. Значение параметра `q` должно быть в пределах от 0 до 95. Если будет указано иное значение или параметр `q` не будет указан вообще, то будет использоваться настройка качества по умолчанию.

#### Пример `curl`-запроса

```sh
curl -X POST -H "Content-Type: image/jpeg" --data-binary @/path/to/image.jpg  "http://localhost:7777/resize?h=1000&w=1000&q=80" >> ~/Downloads/out.jpg
```

Исходное изображение находиться в файле `/path/to/image.jpg`. Результирующее изображение будет размещено в `~/Downloads/out.jpg`.

#### Логика обработки изображения

Изменение размеров изображения всегда происходит без искажения пропорций.

Изображение автоматически поворачивается на основе метаданных об ориентации.

Если указана только высота изображения или только ширина изображения, то у результирующего изображения будет требуемая высота или ширина соответственно. Второе измерение будет вычислено автоматически, исходя из требования сохранения пропорций.

Если указаны оба размера, то изображение будет вписано в указанный прямоугольник. Иными словами размеры изображения будут не больше указанных.
